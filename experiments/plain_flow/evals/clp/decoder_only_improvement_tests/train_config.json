{
  "flow_config": {
    "flow_type": "bare",
    "domain": "u1",
    "base_dist_config": {
      "dist_type": "uniform"
    },
    "layer_chain_config": {
      "layer_configs": {
        "layer_type": "coupling_layer",
        "specific_layer_config": {
          "domain": "u1",
          "specific_layer_type": "bare",
          "diffeomorphism_config": {
            "diffeomorphism_type": "ncp",
            "specific_diffeomorphism_config": {
              "greater_than_func": "exp",
              "boundary_mode": "taylor",
              "beta_exponent": 1
            }
          },
          "initial_rho_id": 0.1
        },
        "conditioner_chain_config": {
          "expressivity": 2,
          "encoder_config": [
            null,
            {
              "encoder_type": "deep_lab_head",
              "specific_encoder_config": {
                "internal_dim": 16,
                "aspp_atrous_rates": [
                  1,
                  3,
                  5
                ],
                "out_channels": 16
              },
              "coord_layer_specifier": null
            },
            {
              "encoder_type": "deep_lab_head",
              "specific_encoder_config": {
                "internal_dim": 16,
                "aspp_atrous_rates": [
                  1,
                  3,
                  5
                ],
                "out_channels": 4
              },
              "coord_layer_specifier": null
            },
            {
              "encoder_type": "deep_lab_head",
              "specific_encoder_config": {
                "internal_dim": 16,
                "aspp_atrous_rates": [
                  1,
                  3,
                  5
                ],
                "out_channels": 4
              },
              "coord_layer_specifier": null
            }
          ],
          "decoder_config": {
            "decoder_type": "mlp",
            "specific_decoder_config": {
              "net_hidden": [
                [
                  120,
                  150,
                  200
                ],
                [
                  120
                ],
                [
                  120
                ],
                [
                  120
                ]
              ]
            }
          },
          "num_decoders": [
            1,
            1,
            1,
            2
          ],
          "share_encoder": [
            false,
            true,
            false,
            false
          ],
          "share_decoder": false
        },
        "num_layers": [
          60,
          60,
          60,
          30
        ],
        "layer_split_config": {
          "split_type": "n_transforms",
          "specific_split_type_config": {
            "n_transformed": [
              1,
              1,
              1,
              2
            ]
          }
        }
      }
    }
  },
  "observables": [
    "Q",
    "Chi_t"
  ],
  "action_config": {
    "target_system": "qr",
    "action_type": "qr",
    "specific_action_config": {
      "T": 4.0,
      "mom_inertia": 0.25
    }
  },
  "dim": [
    60
  ],
  "trainer_configs": {
    "learning_rate": 0.00075,
    "auto_lr_find": false,
    "batch_size": 10000,
    "train_num_batches": 500,
    "val_num_batches": 5,
    "n_iter_eval": 25,
    "batch_size_eval": 10000,
    "max_epochs": 250,
    "log_every_n_steps": 25,
    "accumulate_grad_batches": 4,
    "loss_configs": [
      {
        "loss_type": "reverse",
        "specific_loss_config": {}
      }
    ],
    "gradient_clip_val": 5.0,
    "gradient_clip_algorithm": "norm",
    "lr_scheduler": {
      "type": "reduce_on_plateau",
      "patience": 10,
      "factor": 0.8,
      "min_lr": 5e-5
    }
  },
  "task_parameters": [
    "encoder_config",
    "net_hidden",
    "share_encoder",
    "num_decoders",
    "num_layers",
    "n_transformed"
  ]
}