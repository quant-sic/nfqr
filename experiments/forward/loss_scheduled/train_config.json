{
  "flow_config": {
    "flow_type": "bare",
    "domain": "u1",
    "base_dist_config": {
      "dist_type": "uniform",
      "loc_requires_grad": false,
      "concentration_requires_grad": false,
      "loc": null,
      "concentration_unconstrained": null
    },
    "layer_chain_config": {
      "layers_config": {
        "domain": "u1",
        "coupling_type": "bare",
        "diffeomorphism": "ncp",
        "expressivity": 8,
        "net_config": {
          "net_type": "mlp",
          "net_hidden": [
            50,
            50,
            50
          ]
        }
      },
      "split_type": "checkerboard",
      "num_layers": 5
    }
  },
  "observables": [
    "Chi_t",
    "Q"
  ],
  "action_config": {
    "target_system": "qr",
    "action_type": "qr",
    "specific_action_config": {
      "beta": 1.0
    }
  },
  "dim": [
    25
  ],
  "trainer_config": {
    "learning_rate": 0.001,
    "auto_lr_find": false,
    "batch_size": 5000,
    "train_num_batches": 100,
    "val_num_batches": 5,
    "max_epochs": 1000,
    "log_every_n_steps": 50,
    "task_parameters": [],
    "accumulate_grad_batches": 2,
    "loss_configs": [
      {
        "loss_type": "forward",
        "specific_loss_config": {
          "p_sampler_config": {
            "trajectory_sampler_configs": [
              {
                "trajectory_sampler_config": {
                  "traj_type": "classical",
                  "k": 1.0
                },
                "condition_config": {
                  "params": null
                },
                "sampler_batch_size": 10000
              },
              {
                "trajectory_sampler_config": {
                  "traj_type": "classical",
                  "k": 0.0
                },
                "condition_config": {
                  "params": null
                },
                "sampler_batch_size": 10000
              }
            ],
            "elements_per_dataset": 25000,
            "subset_distribution": [
              1.0,
              0.0
            ],
            "num_workers": 4
          }
        }
      },
      {
        "loss_type": "reverse",
        "specific_loss_config": {}
      }
    ],
    "loss_scheduler_config": {
      "scheduler_type": "loss",
      "specific_scheduler_config": {
        "target_alphas": [
          0.0,
          1.0
        ],
        "initial_alphas": [
          0.5,
          0.5
        ],
        "alpha_step_method": "max_change_comb",
        "n_schedule_steps": 10000,
        "change_rate": 0.01,
        "damping_constant": {
          "Chi_t": 50
        },
        "max_observed_change_rate": {
          "Chi_t": 0.01
        },
        "cooldown_steps": 50,
        "metric_window_length": 1000
      }
    }
  }
}