{
  "flow_config": {
    "flow_type": "bare",
    "domain": "u1",
    "base_dist_config": {
      "dist_type": "uniform"
    },
    "layer_chain_config": {
      "layer_configs": {
        "layer_type": "coupling_layer",
        "specific_layer_config": {
          "domain": "u1",
          "specific_layer_type": "bare",
          "diffeomorphism_config": {
            "diffeomorphism_type": "ncp",
            "specific_diffeomorphism_config": {
              "greater_than_func": "exp",
              "boundary_mode": "taylor"
            }
          },
          "equivariant_mode": "shortest"
        },
        "conditioner_chain_config": {
          "expressivity": 2,
          "encoder_config": null,
          "decoder_config": {
            "decoder_type": "cnn",
            "specific_decoder_config": {
              "block_configs": [
                {
                  "n_channels": [
                    8,
                    12,
                    16
                  ],
                  "kernel_sizes": [
                    5,
                    3,
                    3
                  ]
                }
              ]
            }
          },
          "share_encoder": false,
          "share_decoder": false
        },
        "num_layers": 16,
        "layer_split_config": {
          "split_type": "checkerboard",
          "specific_split_type_config": {}
        }
      }
    }
  },
  "observables": [
    "Q",
    "Chi_t"
  ],
  "action_config": {
    "target_system": "qr",
    "action_type": "qr",
    "specific_action_config": {
      "T": 4.0,
      "mom_inertia": 0.25
    }
  },
  "dim": [
    100
  ],
  "trainer_configs": [
    {
      "learning_rate": 0.001,
      "auto_lr_find": false,
      "batch_size": 10000,
      "train_num_batches": 500,
      "val_num_batches": 5,
      "max_epochs": 250,
      "log_every_n_steps": 25,
      "accumulate_grad_batches": 1,
      "loss_configs": [
        {
          "loss_type": "forward",
          "specific_loss_config": {
            "p_sampler_config": {
              "trajectory_sampler_configs": [
                {
                  "trajectory_sampler_config": {
                    "mcmc_type": "leapfrog",
                    "mcmc_alg": "hmc",
                    "observables": [
                      "Chi_t"
                    ],
                    "n_steps": 100000,
                    "n_burnin_steps": 0,
                    "out_dir": "./",
                    "hmc_engine": "python",
                    "initial_config_sampler_config": {
                      "trajectory_sampler_config": {
                        "traj_type": "classical",
                        "k": -3
                      },
                      "target_system": "qr"
                    }
                  },
                  "condition_config": {
                    "params": {
                      "type": "observable",
                      "target_system": "qr",
                      "value": [
                        -3.0
                      ],
                      "observable": "Q"
                    }
                  }
                },
                {
                  "trajectory_sampler_config": {
                    "mcmc_type": "leapfrog",
                    "mcmc_alg": "hmc",
                    "observables": [
                      "Chi_t"
                    ],
                    "n_steps": 100000,
                    "n_burnin_steps": 0,
                    "out_dir": "./",
                    "hmc_engine": "python",
                    "initial_config_sampler_config": {
                      "trajectory_sampler_config": {
                        "traj_type": "classical",
                        "k": -2
                      },
                      "target_system": "qr"
                    }
                  },
                  "condition_config": {
                    "params": {
                      "type": "observable",
                      "target_system": "qr",
                      "value": [
                        -2.0
                      ],
                      "observable": "Q"
                    }
                  }
                },
                {
                  "trajectory_sampler_config": {
                    "mcmc_type": "leapfrog",
                    "mcmc_alg": "hmc",
                    "observables": [
                      "Chi_t"
                    ],
                    "n_steps": 100000,
                    "n_burnin_steps": 0,
                    "out_dir": "./",
                    "hmc_engine": "python",
                    "initial_config_sampler_config": {
                      "trajectory_sampler_config": {
                        "traj_type": "classical",
                        "k": -1
                      },
                      "target_system": "qr"
                    }
                  },
                  "condition_config": {
                    "params": {
                      "type": "observable",
                      "target_system": "qr",
                      "value": [
                        -1.0
                      ],
                      "observable": "Q"
                    }
                  }
                },
                {
                  "trajectory_sampler_config": {
                    "mcmc_type": "leapfrog",
                    "mcmc_alg": "hmc",
                    "observables": [
                      "Chi_t"
                    ],
                    "n_steps": 100000,
                    "n_burnin_steps": 0,
                    "out_dir": "./",
                    "hmc_engine": "python",
                    "initial_config_sampler_config": {
                      "trajectory_sampler_config": {
                        "traj_type": "classical",
                        "k": 0
                      },
                      "target_system": "qr"
                    }
                  },
                  "condition_config": {
                    "params": {
                      "type": "observable",
                      "target_system": "qr",
                      "value": [
                        0.0
                      ],
                      "observable": "Q"
                    }
                  }
                },
                {
                  "trajectory_sampler_config": {
                    "mcmc_type": "leapfrog",
                    "mcmc_alg": "hmc",
                    "observables": [
                      "Chi_t"
                    ],
                    "n_steps": 100000,
                    "n_burnin_steps": 0,
                    "out_dir": "./",
                    "hmc_engine": "python",
                    "initial_config_sampler_config": {
                      "trajectory_sampler_config": {
                        "traj_type": "classical",
                        "k": 1
                      },
                      "target_system": "qr"
                    }
                  },
                  "condition_config": {
                    "params": {
                      "type": "observable",
                      "target_system": "qr",
                      "value": [
                        1.0
                      ],
                      "observable": "Q"
                    }
                  }
                },
                {
                  "trajectory_sampler_config": {
                    "mcmc_type": "leapfrog",
                    "mcmc_alg": "hmc",
                    "observables": [
                      "Chi_t"
                    ],
                    "n_steps": 100000,
                    "n_burnin_steps": 0,
                    "out_dir": "./",
                    "hmc_engine": "python",
                    "initial_config_sampler_config": {
                      "trajectory_sampler_config": {
                        "traj_type": "classical",
                        "k": 2
                      },
                      "target_system": "qr"
                    }
                  },
                  "condition_config": {
                    "params": {
                      "type": "observable",
                      "target_system": "qr",
                      "value": [
                        2.0
                      ],
                      "observable": "Q"
                    }
                  }
                },{
                  "trajectory_sampler_config": {
                    "mcmc_type": "leapfrog",
                    "mcmc_alg": "hmc",
                    "observables": [
                      "Chi_t"
                    ],
                    "n_steps": 100000,
                    "n_burnin_steps": 0,
                    "out_dir": "./",
                    "hmc_engine": "python",
                    "initial_config_sampler_config": {
                      "trajectory_sampler_config": {
                        "traj_type": "classical",
                        "k": 3
                      },
                      "target_system": "qr"
                    }
                  },
                  "condition_config": {
                    "params": {
                      "type": "observable",
                      "target_system": "qr",
                      "value": [
                        3.0
                      ],
                      "observable": "Q"
                    }
                  }
                }
              ],
              "batch_size": 1,
              "elements_per_dataset": 50000,
              "subset_distribution": [
                0.05,
                0.1,
                0.2,
                0.3,
                0.2,
                0.1,
                0.05
              ],
              "num_workers": 0,
              "num_batches": 1,
              "shuffle": true,
              "infinite": false
            }
          }
        },
        {
          "loss_type": "reverse",
          "specific_loss_config": {}
        }
      ],
      "gradient_clip_val": 5.0,
      "gradient_clip_algorithm": "norm",
      "loss_scheduler_config": {
        "scheduler_type": "loss",
        "specific_scheduler_config": {
          "target_alphas": [
            0.0,
            1.0
          ],
          "initial_alphas": [
            0.4,
            0.6
          ],
          "alpha_step_method": "max_change_comb",
          "n_schedule_steps": 175000,
          "change_rate": 0.01,
          "damping_constant": {
            "Chi_t": 50
          },
          "max_observed_change_rate": {
            "Chi_t": 0.01
          },
          "cooldown_steps": 100,
          "metric_window_length": 1000
        }
      }
    },
    {
      "learning_rate": 0.001,
      "auto_lr_find": false,
      "batch_size": 10000,
      "train_num_batches": 100,
      "val_num_batches": 5,
      "max_epochs": 100,
      "log_every_n_steps": 25,
      "accumulate_grad_batches": 1,
      "loss_configs": [
        {
          "loss_type": "reverse",
          "specific_loss_config": {}
        }
      ],
      "gradient_clip_val": 5.0,
      "gradient_clip_algorithm": "norm",
      "lr_scheduler": {
        "type": "reduce_on_plateau",
        "patience": 10,
        "factor": 0.9,
        "min_lr": 1e-5
      }
    }
  ],
  "task_parameters": []
}